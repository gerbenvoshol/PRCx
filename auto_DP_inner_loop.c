// automatically generated by write_DP_loops.pl

#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp5_best
		(
			&Tr[m1][m2][sMM],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp4_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp4_best
	(
		&Tr[m1][m2][sMI],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDM] = 
	comp3_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp3_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp3_best
	(
		&Tr[m1][m2][sMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp3_best
	(
		&Tr[m1][m2][sMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp4_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp4_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDM] = 
	comp3_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp4_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp4_best
		(
			&Tr[m1][m2][sMI],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp5_best
		(
			&Tr[m1][m2][sMM],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp6_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp4_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp4_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp4_best
	(
		&Tr[m1][m2][sMI],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDM] = 
	comp4_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp3_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp4_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp3_best
	(
		&Tr[m1][m2][sMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp4_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp4_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp4_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp4_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sMD, S[m1-1][m2-1][sMD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp4_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp4_best
		(
			&Tr[m1][m2][sMI],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp6_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp1_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp1_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp8_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp1_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp1_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp8_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp1_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp1_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp4_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD],
		sIM, S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp5_best
	(
		&Tr[m1][m2][sIM],
		sID, S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp5_best
	(
		&Tr[m1][m2][sMI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp8_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp3_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp4_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp3_best
	(
		&Tr[m1][m2][sID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp4_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp4_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp4_best
	(
		&Tr[m1][m2][sMI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp4_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD],
		S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp5_sum
	(
		S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp5_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp8_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp3_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp4_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp4_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp4_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sMD, S[m1-1][m2-1][sMD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp2_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI],
			sMI, S[m1-1][ m2 ][sMI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp2_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp5_best
		(
			&Tr[m1][m2][sIM],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp5_best
		(
			&Tr[m1][m2][sMI],
			sDI, S[m1-1][ m2 ][sDI],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp1_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp1_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp9_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sII, S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp1_best
	(
		&Tr[m1][m2][sII],
		sMM, S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp1_best
	(
		&Tr[m1][m2][sII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp7_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp1_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp1_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp9_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
	S[m1][m2][sII] = 
	comp1_sum
	(
		S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sII] = 
	comp1_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp1_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp1_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp4_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD],
		sIM, S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp6_best
	(
		&Tr[m1][m2][sIM],
		sID, S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		sII, S[ m1 ][m2-1][sII] x St1[m1][tII] x St2[m2][tIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp6_best
	(
		&Tr[m1][m2][sMI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sII, S[m1-1][ m2 ][sII] x St1[m1][tIM] x St2[m2][tII],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp9_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sII, S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp3_best
	(
		&Tr[m1][m2][sII],
		sIM, S[ m1 ][ m2 ][sIM] x St1[m1][tII] x St2[m2][tMI],
		sMI, S[ m1 ][ m2 ][sMI] x St1[m1][tMI] x St2[m2][tII],
		sMM, S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp3_best
	(
		&Tr[m1][m2][sII],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp3_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp4_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp3_best
	(
		&Tr[m1][m2][sID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp5_best
	(
		&Tr[m1][m2][sIM],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp4_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp5_best
	(
		&Tr[m1][m2][sMI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tII],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp7_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp4_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD],
		S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp6_sum
	(
		S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		S[ m1 ][m2-1][sII] x St1[m1][tII] x St2[m2][tIM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp6_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sII] x St1[m1][tIM] x St2[m2][tII],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp9_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
	S[m1][m2][sII] = 
	comp3_sum
	(
		S[ m1 ][ m2 ][sIM] x St1[m1][tII] x St2[m2][tMI],
		S[ m1 ][ m2 ][sMI] x St1[m1][tMI] x St2[m2][tII],
		S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sII] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp3_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp3_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp5_sum
	(
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp5_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tII],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN7
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp4_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sMD, S[m1-1][m2-1][sMD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp2_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI],
			sMI, S[m1-1][ m2 ][sMI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp2_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp5_best
		(
			&Tr[m1][m2][sIM],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp5_best
		(
			&Tr[m1][m2][sMI],
			sDI, S[m1-1][ m2 ][sDI],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp5_best
		(
			&Tr[m1][m2][sMM],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDM] = 
	comp3_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tID],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp5_best
	(
		&Tr[m1][m2][sIM],
		sDM, S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp3_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMI, S[ m1 ][m2-1][sMI] x St2[m2][tID],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp5_best
	(
		&Tr[m1][m2][sMI],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMD, S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDM] = 
	comp4_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp4_best
	(
		&Tr[m1][m2][sIM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp4_best
	(
		&Tr[m1][m2][sMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp4_best
	(
		&Tr[m1][m2][sMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	S[m1][m2][sMM] = 
	comp5_best
	(
		&Tr[m1][m2][sMM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDM] = 
	comp3_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sIM] x St1[m1][tID],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp5_sum
	(
		S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp3_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMI] x St2[m2][tID],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp5_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDM] = 
	comp4_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp4_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp4_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp4_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp5_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE5
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp3_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp5_best
		(
			&Tr[m1][m2][sIM],
			sDM, S[ m1 ][m2-1][sDM],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp3_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp5_best
		(
			&Tr[m1][m2][sMI],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMD, S[m1-1][ m2 ][sMD],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp5_best
		(
			&Tr[m1][m2][sMM],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp6_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp6_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp3_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tID],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp6_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		sDM, S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp3_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMI, S[ m1 ][m2-1][sMI] x St2[m2][tID],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp6_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMD, S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp4_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDM] = 
	comp5_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp5_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp5_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp5_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp6_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp3_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sIM] x St1[m1][tID],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp6_sum
	(
		S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp3_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMI] x St2[m2][tID],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp6_sum
	(
		S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDM] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sIM] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE6
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp6_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp3_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp6_best
		(
			&Tr[m1][m2][sIM],
			sDD, S[ m1 ][m2-1][sDD],
			sDM, S[ m1 ][m2-1][sDM],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp3_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp6_best
		(
			&Tr[m1][m2][sMI],
			sDD, S[m1-1][ m2 ][sDD],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMD, S[m1-1][ m2 ][sMD],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp6_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDM, S[m1-1][m2-1][sDM],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp1_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp1_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp8_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp1_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp1_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp8_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp1_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp1_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp8_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDD] x St2[m2][tID],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sID, S[m1-1][m2-1][sID] x St1[m1][tID] x St2[m2][tDD],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp3_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tID],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD],
		sIM, S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp8_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		sDI, S[ m1 ][m2-1][sDI] x St1[m1][tDI] x St2[m2][tIM],
		sDM, S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		sID, S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp3_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMI, S[ m1 ][m2-1][sMI] x St2[m2][tID],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp8_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sID, S[m1-1][ m2 ][sID] x St1[m1][tIM] x St2[m2][tDI],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMD, S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp8_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sDD] = 
	comp4_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp5_best
	(
		&Tr[m1][m2][sDI],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tID],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp5_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp5_best
	(
		&Tr[m1][m2][sID],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp6_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp5_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp6_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	S[m1][m2][sMM] = 
	comp6_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp8_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDI] x St1[m1][tDD] x St2[m2][tID],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sID] x St1[m1][tID] x St2[m2][tDD],
		S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp3_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sIM] x St1[m1][tID],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD],
		S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp8_sum
	(
		S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		S[ m1 ][m2-1][sDI] x St1[m1][tDI] x St2[m2][tIM],
		S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp3_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMI] x St2[m2][tID],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp8_sum
	(
		S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sID] x St1[m1][tIM] x St2[m2][tDI],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp8_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sDD] = 
	comp4_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tID],
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE8
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp8_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp2_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI],
			sMI, S[m1-1][ m2 ][sMI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp3_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp2_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp8_best
		(
			&Tr[m1][m2][sIM],
			sDD, S[ m1 ][m2-1][sDD],
			sDI, S[ m1 ][m2-1][sDI],
			sDM, S[ m1 ][m2-1][sDM],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp3_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp8_best
		(
			&Tr[m1][m2][sMI],
			sDD, S[m1-1][ m2 ][sDD],
			sDI, S[m1-1][ m2 ][sDI],
			sDM, S[m1-1][ m2 ][sDM],
			sID, S[m1-1][ m2 ][sID],
			sIM, S[m1-1][ m2 ][sIM],
			sMD, S[m1-1][ m2 ][sMD],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp1_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp1_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp9_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sII, S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp1_best
	(
		&Tr[m1][m2][sII],
		sMM, S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp1_best
	(
		&Tr[m1][m2][sII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDD] = 
	comp2_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp2_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp2_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp2_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp2_best
	(
		&Tr[m1][m2][sIM],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp2_best
	(
		&Tr[m1][m2][sMD],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp2_best
	(
		&Tr[m1][m2][sMI],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sMM] = 
	comp7_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp1_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp1_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp9_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
	S[m1][m2][sII] = 
	comp1_sum
	(
		S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sII] = 
	comp1_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == VIA_MM
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp2_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp1_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp2_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp1_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp2_best
		(
			&Tr[m1][m2][sIM],
			sIM, S[ m1 ][m2-1][sIM],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp2_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp2_best
		(
			&Tr[m1][m2][sMI],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VITERBI
	
	S[m1][m2][sDD] = 
	comp9_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDD] x St2[m2][tID],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		sID, S[m1-1][m2-1][sID] x St1[m1][tID] x St2[m2][tDD],
		sII, S[m1-1][m2-1][sII] x St1[m1][tID] x St2[m2][tID],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	S[m1][m2][sDI] = 
	comp3_best
	(
		&Tr[m1][m2][sDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		sII, S[m1-1][ m2 ][sII] x St1[m1][tID],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	S[m1][m2][sDM] = 
	comp3_best
	(
		&Tr[m1][m2][sDM],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tID],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	S[m1][m2][sID] = 
	comp3_best
	(
		&Tr[m1][m2][sID],
		sID, S[ m1 ][m2-1][sID] x St2[m2][tDD],
		sII, S[ m1 ][m2-1][sII] x St2[m2][tID],
		sIM, S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp9_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		sDI, S[ m1 ][m2-1][sDI] x St1[m1][tDI] x St2[m2][tIM],
		sDM, S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		sID, S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		sII, S[ m1 ][m2-1][sII] x St1[m1][tII] x St2[m2][tIM],
		sIM, S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		sMD, S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		sMI, S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		sMM, S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp3_best
	(
		&Tr[m1][m2][sMD],
		sMD, S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		sMI, S[ m1 ][m2-1][sMI] x St2[m2][tID],
		sMM, S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp9_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		sDI, S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		sDM, S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		sID, S[m1-1][ m2 ][sID] x St1[m1][tIM] x St2[m2][tDI],
		sII, S[m1-1][ m2 ][sII] x St1[m1][tIM] x St2[m2][tII],
		sIM, S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		sMD, S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		sMI, S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		sMM, S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	S[m1][m2][sMM] = 
	comp9_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		sDI, S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		sDM, S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		sID, S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		sII, S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		sIM, S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		sMD, S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		sMI, S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		sMM, S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp8_best
	(
		&Tr[m1][m2][sII],
		sDD, S[ m1 ][ m2 ][sDD] x St1[m1][tDI] x St2[m2][tDI],
		sDI, S[ m1 ][ m2 ][sDI] x St1[m1][tDI] x St2[m2][tII],
		sDM, S[ m1 ][ m2 ][sDM] x St1[m1][tDI] x St2[m2][tMI],
		sID, S[ m1 ][ m2 ][sID] x St1[m1][tII] x St2[m2][tDI],
		sIM, S[ m1 ][ m2 ][sIM] x St1[m1][tII] x St2[m2][tMI],
		sMD, S[ m1 ][ m2 ][sMD] x St1[m1][tMI] x St2[m2][tDI],
		sMI, S[ m1 ][ m2 ][sMI] x St1[m1][tMI] x St2[m2][tII],
		sMM, S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == VIT_BACK
	
	S[m1][m2][sII] = X[m1][m2][xII] x 
	comp6_best
	(
		&Tr[m1][m2][sII],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tID],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tID],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tIM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tID],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDD] = 
	comp5_best
	(
		&Tr[m1][m2][sDD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tDI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sDI] = 
	comp6_best
	(
		&Tr[m1][m2][sDI],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tID],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tII],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	S[m1][m2][sDM] = 
	comp6_best
	(
		&Tr[m1][m2][sDM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sID] = 
	comp6_best
	(
		&Tr[m1][m2][sID],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tDD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tDI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	S[m1][m2][sIM] = X[m1][m2][xIM] x 
	comp7_best
	(
		&Tr[m1][m2][sIM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		sID, S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	S[m1][m2][sMD] = 
	comp6_best
	(
		&Tr[m1][m2][sMD],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tDI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	S[m1][m2][sMI] = X[m1][m2][xMI] x 
	comp7_best
	(
		&Tr[m1][m2][sMI],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		sDI, S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tII],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	S[m1][m2][sMM] = 
	comp7_best
	(
		&Tr[m1][m2][sMM],
		sDD, S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		sDM, S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		sII, S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		sIM, S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		sMI, S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		sMM, S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		sMD, S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] xeq X[m1][m2][xMM];
	
	if( S[m1][m2][sMM] < StIn )
	{
		S[m1][m2][sMM] = StIn;
		
		// N.B. sBE is now indicated by Tr < 0
		Tr[m1][m2][sMM] -= 20;
	};
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == FORWARD
	
	S[m1][m2][sDD] = 
	comp9_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDD] x St2[m2][tDD],
		S[m1-1][m2-1][sDI] x St1[m1][tDD] x St2[m2][tID],
		S[m1-1][m2-1][sDM] x St1[m1][tDD] x St2[m2][tMD],
		S[m1-1][m2-1][sID] x St1[m1][tID] x St2[m2][tDD],
		S[m1-1][m2-1][sII] x St1[m1][tID] x St2[m2][tID],
		S[m1-1][m2-1][sIM] x St1[m1][tID] x St2[m2][tMD],
		S[m1-1][m2-1][sMD] x St1[m1][tMD] x St2[m2][tDD],
		S[m1-1][m2-1][sMI] x St1[m1][tMD] x St2[m2][tID],
		S[m1-1][m2-1][sMM] x St1[m1][tMD] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp3_sum
	(
		S[m1-1][ m2 ][sDI] x St1[m1][tDD],
		S[m1-1][ m2 ][sII] x St1[m1][tID],
		S[m1-1][ m2 ][sMI] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp3_sum
	(
		S[m1-1][ m2 ][sDM] x St1[m1][tDD],
		S[m1-1][ m2 ][sIM] x St1[m1][tID],
		S[m1-1][ m2 ][sMM] x St1[m1][tMD]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp3_sum
	(
		S[ m1 ][m2-1][sID] x St2[m2][tDD],
		S[ m1 ][m2-1][sII] x St2[m2][tID],
		S[ m1 ][m2-1][sIM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp9_sum
	(
		S[ m1 ][m2-1][sDD] x St1[m1][tDI] x St2[m2][tDM],
		S[ m1 ][m2-1][sDI] x St1[m1][tDI] x St2[m2][tIM],
		S[ m1 ][m2-1][sDM] x St1[m1][tDI] x St2[m2][tMM],
		S[ m1 ][m2-1][sID] x St1[m1][tII] x St2[m2][tDM],
		S[ m1 ][m2-1][sII] x St1[m1][tII] x St2[m2][tIM],
		S[ m1 ][m2-1][sIM] x St1[m1][tII] x St2[m2][tMM],
		S[ m1 ][m2-1][sMD] x St1[m1][tMI] x St2[m2][tDM],
		S[ m1 ][m2-1][sMI] x St1[m1][tMI] x St2[m2][tIM],
		S[ m1 ][m2-1][sMM] x St1[m1][tMI] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp3_sum
	(
		S[ m1 ][m2-1][sMD] x St2[m2][tDD],
		S[ m1 ][m2-1][sMI] x St2[m2][tID],
		S[ m1 ][m2-1][sMM] x St2[m2][tMD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp9_sum
	(
		S[m1-1][ m2 ][sDD] x St1[m1][tDM] x St2[m2][tDI],
		S[m1-1][ m2 ][sDI] x St1[m1][tDM] x St2[m2][tII],
		S[m1-1][ m2 ][sDM] x St1[m1][tDM] x St2[m2][tMI],
		S[m1-1][ m2 ][sID] x St1[m1][tIM] x St2[m2][tDI],
		S[m1-1][ m2 ][sII] x St1[m1][tIM] x St2[m2][tII],
		S[m1-1][ m2 ][sIM] x St1[m1][tIM] x St2[m2][tMI],
		S[m1-1][ m2 ][sMD] x St1[m1][tMM] x St2[m2][tDI],
		S[m1-1][ m2 ][sMI] x St1[m1][tMM] x St2[m2][tII],
		S[m1-1][ m2 ][sMM] x St1[m1][tMM] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp9_sum
	(
		S[m1-1][m2-1][sDD] x St1[m1][tDM] x St2[m2][tDM],
		S[m1-1][m2-1][sDI] x St1[m1][tDM] x St2[m2][tIM],
		S[m1-1][m2-1][sDM] x St1[m1][tDM] x St2[m2][tMM],
		S[m1-1][m2-1][sID] x St1[m1][tIM] x St2[m2][tDM],
		S[m1-1][m2-1][sII] x St1[m1][tIM] x St2[m2][tIM],
		S[m1-1][m2-1][sIM] x St1[m1][tIM] x St2[m2][tMM],
		S[m1-1][m2-1][sMD] x St1[m1][tMM] x St2[m2][tDM],
		S[m1-1][m2-1][sMI] x St1[m1][tMM] x St2[m2][tIM],
		S[m1-1][m2-1][sMM] x St1[m1][tMM] x St2[m2][tMM]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
	S[m1][m2][sII] = 
	comp8_sum
	(
		S[ m1 ][ m2 ][sDD] x St1[m1][tDI] x St2[m2][tDI],
		S[ m1 ][ m2 ][sDI] x St1[m1][tDI] x St2[m2][tII],
		S[ m1 ][ m2 ][sDM] x St1[m1][tDI] x St2[m2][tMI],
		S[ m1 ][ m2 ][sID] x St1[m1][tII] x St2[m2][tDI],
		S[ m1 ][ m2 ][sIM] x St1[m1][tII] x St2[m2][tMI],
		S[ m1 ][ m2 ][sMD] x St1[m1][tMI] x St2[m2][tDI],
		S[ m1 ][ m2 ][sMI] x St1[m1][tMI] x St2[m2][tII],
		S[ m1 ][ m2 ][sMM] x St1[m1][tMI] x St2[m2][tMI]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == BACKWARD
	
	S[m1][m2][sII] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tID],
		S[m1+1][ m2 ][sDI] x St1[m1+1][tID],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tIM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tID],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sII] xeq S[m1][m2][sII];
	
	S[m1][m2][sII] xeq X[m1][m2][xII];
	
	S[m1][m2][sDD] = 
	comp5_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tDD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tDI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sDD] xeq S[m1][m2][sDD];
	
	S[m1][m2][sDI] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tID],
		S[m1+1][ m2 ][sDI] x St1[m1+1][tDD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tII],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tIM]
	);
	
	other_S[m1][m2][sDI] xeq S[m1][m2][sDI];
	
	S[m1][m2][sDM] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tDD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tDD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tDI] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tDI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tDM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tDM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sDM] xeq S[m1][m2][sDM];
	
	S[m1][m2][sID] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tDD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tDI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tDD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tDM]
	);
	
	other_S[m1][m2][sID] xeq S[m1][m2][sID];
	
	S[m1][m2][sIM] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tID],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tII] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tII] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sID] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tIM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tIM] x St2[m2+1][tMM]
	);
	
	other_S[m1][m2][sIM] xeq S[m1][m2][sIM];
	
	S[m1][m2][sIM] xeq X[m1][m2][xIM];
	
	S[m1][m2][sMD] = 
	comp6_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tDD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tDI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tDM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tDI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tDM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tDD]
	);
	
	other_S[m1][m2][sMD] xeq S[m1][m2][sMD];
	
	S[m1][m2][sMI] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tID],
		S[m1+1][ m2 ][sDI] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tII],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tIM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tII],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tIM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tID]
	);
	
	other_S[m1][m2][sMI] xeq S[m1][m2][sMI];
	
	S[m1][m2][sMI] xeq X[m1][m2][xMI];
	
	S[m1][m2][sMM] = 
	comp7_sum
	(
		S[m1+1][m2+1][sDD] x St1[m1+1][tMD] x St2[m2+1][tMD],
		S[m1+1][ m2 ][sDM] x St1[m1+1][tMD],
		S[ m1 ][ m2 ][sII] x St1[ m1 ][tMI] x St2[ m2 ][tMI],
		S[ m1 ][m2+1][sIM] x St1[ m1 ][tMI] x St2[m2+1][tMM],
		S[m1+1][ m2 ][sMI] x St1[m1+1][tMM] x St2[ m2 ][tMI],
		S[m1+1][m2+1][sMM] x St1[m1+1][tMM] x St2[m2+1][tMM],
		S[ m1 ][m2+1][sMD] x St2[m2+1][tMD]
	);
	
	other_S[m1][m2][sMM] xeq S[m1][m2][sMM];
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	temp = S[m1][m2][sMM] x StOut;
	dp->sum_S = comp2_sum( dp->sum_S, temp );
	
	if( dp->best_S < temp )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM] x X[m1][m2][xMM],
		StIn
	);
#endif
#endif
#endif
#endif
	
	
#if PROF_HMM_TRANS  == PLAN9
#if PAIR_HMM_STATES == SPACE9
#if PAIR_HMM_TRANS  == ALL_TRANS
#if ALGORITHM       == OPT_ACCUR
	
	S[m1][m2][sDD] = 
	comp2_sum
	(
		S[m1][m2][sDD],
		comp8_best
		(
			&Tr[m1][m2][sDD],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
	S[m1][m2][sDI] = 
	comp2_sum
	(
		S[m1][m2][sDI],
		comp2_best
		(
			&Tr[m1][m2][sDI],
			sDI, S[m1-1][ m2 ][sDI],
			sMI, S[m1-1][ m2 ][sMI]
		)
	);
	
	S[m1][m2][sDM] = 
	comp2_sum
	(
		S[m1][m2][sDM],
		comp3_best
		(
			&Tr[m1][m2][sDM],
			sDM, S[m1-1][ m2 ][sDM],
			sIM, S[m1-1][ m2 ][sIM],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sID] = 
	comp2_sum
	(
		S[m1][m2][sID],
		comp2_best
		(
			&Tr[m1][m2][sID],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM]
		)
	);
	
	S[m1][m2][sIM] = 
	comp2_sum
	(
		S[m1][m2][sIM],
		comp8_best
		(
			&Tr[m1][m2][sIM],
			sDD, S[ m1 ][m2-1][sDD],
			sDI, S[ m1 ][m2-1][sDI],
			sDM, S[ m1 ][m2-1][sDM],
			sID, S[ m1 ][m2-1][sID],
			sIM, S[ m1 ][m2-1][sIM],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMD] = 
	comp2_sum
	(
		S[m1][m2][sMD],
		comp3_best
		(
			&Tr[m1][m2][sMD],
			sMD, S[ m1 ][m2-1][sMD],
			sMI, S[ m1 ][m2-1][sMI],
			sMM, S[ m1 ][m2-1][sMM]
		)
	);
	
	S[m1][m2][sMI] = 
	comp2_sum
	(
		S[m1][m2][sMI],
		comp8_best
		(
			&Tr[m1][m2][sMI],
			sDD, S[m1-1][ m2 ][sDD],
			sDI, S[m1-1][ m2 ][sDI],
			sDM, S[m1-1][ m2 ][sDM],
			sID, S[m1-1][ m2 ][sID],
			sIM, S[m1-1][ m2 ][sIM],
			sMD, S[m1-1][ m2 ][sMD],
			sMI, S[m1-1][ m2 ][sMI],
			sMM, S[m1-1][ m2 ][sMM]
		)
	);
	
	S[m1][m2][sMM] = 
	comp2_sum
	(
		S[m1][m2][sMM],
		comp8_best
		(
			&Tr[m1][m2][sMM],
			sDD, S[m1-1][m2-1][sDD],
			sDI, S[m1-1][m2-1][sDI],
			sDM, S[m1-1][m2-1][sDM],
			sID, S[m1-1][m2-1][sID],
			sIM, S[m1-1][m2-1][sIM],
			sMD, S[m1-1][m2-1][sMD],
			sMI, S[m1-1][m2-1][sMI],
			sMM, S[m1-1][m2-1][sMM]
		)
	);
	
#if ALGO_SPACE == LINSPACE
	if( S[m1][m2][sMM] > MAX_FLOAT ) 
	{
		dp->lin_overflow=1;
	};
#endif
	
	if( dp->best_S < (temp = S[m1][m2][sMM] x StOut) )
	{
		dp->best_S  = temp;
		dp->best_m1 = m1;
		dp->best_m2 = m2;
	};
	
#endif
#endif
#endif
#endif
	
	
